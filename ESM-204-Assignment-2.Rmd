---
title: "ESM 204 Assignment 2"
author: "Adrienne Hewitt, Alex Brown"
date: "April 26, 2019"
output: html_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, include=FALSE, warning=FALSE}

library(tidyverse)
library(knitr)
library(kableExtra)
library(plotly)
library(pwr)
library(car)
library(RColorBrewer)
library(extrafont)
library(ggrepel)
library(effsize)
library(ggpubr)
library(vcdExtra)
library(dplyr)
library(RColorBrewer)
library(corrplot) 
library(janitor) 
library(lubridate) 
library(gganimate)
library(ggimage)
library(stargazer)
```

```{r, include=FALSE, warning=FALSE}

original_data<-read_csv("Hmwk2_Data.csv")

```

###1

```{r, include=FALSE}
#Modeling low and high income demand curves from raw data

low_demand<-lm(Price_Dollars~Q_Low_Gallons_per_Day, data=original_data)

high_demand<-lm(Price_Dollars~Q_High_Gallons_per_Day, data=original_data)

summary(low_demand)

summary(high_demand)

```


```{r}
#defining low demand
lowdemand<-function(x) { 21.9908534 -0.0001355*x}

#defining high demand
highdemand<-function(x) {23.3914418-0.0001297*x}

#defining aggregate demand
aggdemand<-function(x) {22.70647-0.00006626831*x}

#defining supply
supply<-function(x) {0.00001871302*x}

#defining MEC
MEC<-function(x) {2}

```

```{r, echo=FALSE}
#First attempt at graphing demand curves, WRONG
demand_plots <- ggplot(original_data, aes(x=Q_Low_Gallons_per_Day, y=Price_Dollars))+
  geom_line()+
  geom_line(color="blue", aes(x=Q_High_Gallons_per_Day)) +
  geom_smooth(method = lm)

demand_plots
```

```{r, echo=FALSE}
#Second attempt at graphing demand curves, QUESTIONABLE
demand_curves <- ggplot(data=original_data, aes(x=Q_High_Gallons_per_Day, y=Price_Dollars)) + geom_line(aes(colour=Q_Low_Gallons_per_Day)) + geom_smooth(aes(group=Q_High_Gallons_per_Day))

demand_curves

demand_curve <- ggplot(data.frame(x = c(0, 150000)), aes(x = x)) +
        stat_function(fun = dnorm, args = list(200, 100)) +
        stat_function(fun = dnorm, args = list(700, 50))


demand_curve
```

```{r}
#Third attempt
lowcurve<-ggplot(data.frame(x=c(0,500000)), aes(x=x))+
  stat_function(fun=lowdemand)

highcurve<-ggplot(data.frame(x=c(0,500000)), aes(x=x))+
  stat_function(fun=highdemand)

aggdemandcurve<-ggplot(data.frame(x=c(0,500000)), aes(x=x))+
  stat_function(fun=aggdemand)

supplycurve<-ggplot(data.frame(x=c(0,500000)), aes(x=x))+
  stat_function(fun=supply)

MECcurve<-ggplot(data.frame(x=c(0,500000)), aes(x=x))+
  stat_function(fun=MEC)
#______________________________________________________________________
#Attempting to look at the complete supply/demand graph

gasgraph<-ggplot(data.frame(x=c(0,400000)), aes(x=x))+
  stat_function(fun=lowdemand, color="yellow")+
  stat_function(fun=highdemand, color="pink")+
  stat_function(fun=aggdemand, color="purple")+
  stat_function(fun=supply, color="brown")+
  stat_function(fun=MEC)+
  ylim(0,30)

gasgraph
```

Question1:
#Price is $5/gallon

#What is the aggregate daily demand curve for gas in France?
#P=22.70647-0.00006626831(Q)

#What is the supply curve for gas?
#P=0.00001871302(Q)

#What is the benefit to consumers? Area below aggdemand curve and above P=5
#0.5*267193.6*17.70647=2365528

#What is the benefit to producers? Area below P=5 and above supply curve
#0.5*5*267193.6=667984

#What is the environmental cost? Q*x2
#267193.6*2=534387.2

______________________________________________________________________

Question 2: How is the current consumer benefit divided between "High" and "Low" income consumers? 
#I calculated Q at P=5, then used that to calculate surpluses under each demand curve
# 0.5*16.99085*125393.8; Low income consumer benefit=1065274
# 0.5*18.39144*141799.9; High income consumer benefit=1303952

#Adding up low and high consumer benefit is $400+ over aggregate consumer benefit, so must check

_______________________________________________________________________

Question 3: A gas tax of $0.50/gal is proposed. What would be its effects on:
a) the amount of gas produced and sold
b)the price of gas
c) welfare of "high" income consumers
d) welfare of "low" income consumers
e) welfare of gas producers
f) total environmental damage
g) total revenue generated by the tax


